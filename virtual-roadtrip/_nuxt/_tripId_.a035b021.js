import{_ as R}from"./PixelatedImage.78eb34e3.js";import{_ as U}from"./Map.vue.40009a79.js";import{a as P,k as l,r as $,b as F,o as f,e as x,u as t,l as o,t as _,h as b,p as v,y as S,m as X,q as I,F as W,s as j,v as K,x as B,i as O,c as G}from"./entry.1b282f1e.js";import"./app.config.8fe53bf3.js";const C=p=>(j("data-v-4fbbb27c"),p=p(),K(),p),J={key:0,class:"data flexcolumn"},Q=C(()=>o("br",null,null,-1)),Y=C(()=>o("br",null,null,-1)),Z=C(()=>o("div",{class:"barbg"},null,-1)),ee={key:1,class:"maps flex gap"},te=P({__name:"Hud",props:{trip:null,currentStageIndex:null},emits:["changeStage"],setup(p,{emit:y}){const n=p,d=l(()=>{var e;return(e=n==null?void 0:n.trip)==null?void 0:e.map(r=>[r.location[1],r.location[0]])}),a=l(()=>{var e;return(e=n==null?void 0:n.trip)==null?void 0:e[n==null?void 0:n.currentStageIndex]}),u=l(()=>{var e;return(e=n==null?void 0:n.trip)==null?void 0:e[(n==null?void 0:n.currentStageIndex)+1]}),w=l(()=>{var g;const e=a.value.location,r=((g=u==null?void 0:u.value)==null?void 0:g.location)||e;return Math.atan2(r[1]-e[1],r[0]-e[0])*(180/Math.PI)}),k=l(()=>{let e=w.value;return e<0&&(e+=360),e>=360&&(e-=360),e<22.5?"N":e<67.5?"NE":e<112.5?"E":e<157.5?"SE":e<202.5?"S":e<247.5?"SW":e<292.5?"W":e<337.5?"NW":"N"}),c=l(()=>{var e,r,s;return new Date((s=(r=(e=n==null?void 0:n.trip)==null?void 0:e[0])==null?void 0:r.weather)==null?void 0:s.timeThere).getTime()}),h=l(()=>{var e,r,s;return new Date((s=(r=(e=n==null?void 0:n.trip)==null?void 0:e[n.trip.length-1])==null?void 0:r.weather)==null?void 0:s.timeThere).getTime()}),T=l(()=>h.value-c.value),i=l(()=>{var e;return new Date((e=a.value)==null?void 0:e.weather.timeThere).getTime()}),M=l(()=>(i.value-c.value)/T.value),m=$(0);function L(e){var g,D;const r=e.clientX-(((g=e.currentTarget)==null?void 0:g.offsetLeft)||0),s=((D=e.currentTarget)==null?void 0:D.clientWidth)||0;m.value=r/s+.5}function V(e){var E,N;const r=e.clientX-(((E=e.currentTarget)==null?void 0:E.offsetLeft)||0),s=((N=e.currentTarget)==null?void 0:N.clientWidth)||0,g=r/s+.5-.005,D=c.value+g*T.value,H=n.trip.find(z=>new Date(z.weather.timeThere).getTime()>=D),q=Math.max(0,Math.round(n.trip.indexOf(H)));y("changeStage",q)}function A(){m.value=0}return F(()=>{window.addEventListener("keydown",e=>{if(e.key==="ArrowLeft"?y("changeStage",Math.max(0,n.currentStageIndex-1)):e.key==="ArrowRight"&&y("changeStage",Math.min(n.trip.length-1,n.currentStageIndex+1)),e.key==="f"){const r=document.documentElement;document.fullscreenElement?document.exitFullscreen():r.requestFullscreen().catch(s=>{alert(`Error attempting to enable full-screen mode: ${s.message} (${s.name})`)})}})}),(e,r)=>{const s=U;return f(),x(W,null,[t(a)?(f(),x("div",J,[o("div",null,[o("b",null,_(new Date(t(a).weather.timeThere).toLocaleTimeString("en-US",{hour:"numeric",minute:"numeric"})),1),Q,b(" "+_(new Date(t(a).weather.timeThere).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})),1)]),o("div",null,[b(_(t(a).locationData.distanceToCityInKm.toFixed(0))+"km outside of ",1),Y,o("b",null,_(t(a).locationData.nearestCity)+", "+_(t(a).locationData.state?t(a).locationData.state+",":"")+" "+_(t(a).locationData.country||t(a).locationData.continent),1)]),o("div",null,[b(" Traveling "),o("b",null,[o("div",{class:"arrow",style:v({transform:`rotate(${t(w)-90}deg)`})}," â†’ ",4),b(" "+_(t(k)),1)]),b(" at "+_(Math.round(t(a).kph))+"km/h ",1)])])):S("",!0),o("div",{class:"progress",onMousemove:L,onClick:V,onMouseleave:A},[o("div",{class:X(["downcaret",{transition:!t(m)}]),style:v({left:(t(m)||t(M))*100+"%"})},null,6),o("div",{class:"bar",style:v({width:`${t(M)*100}%`})},null,4),Z],32),t(a)?(f(),x("div",ee,[I(s,{coords:[t(a).location[1],t(a).location[0]],scale:60,width:80,height:80,path:t(d)},null,8,["coords","path"]),I(s,{coords:[t(a).location[1],t(a).location[0]],scale:350,width:80,height:80,path:t(d)},null,8,["coords","path"]),I(s,{coords:[t(a).location[1],t(a).location[0]],scale:2e3,width:80,height:80,path:t(d)},null,8,["coords","path"])])):S("",!0)],64)}}});const ne=B(te,[["__scopeId","data-v-4fbbb27c"]]),ae={class:"frame"},re={class:"reflectionclip1"},oe=["src"],se={class:"reflectionclip2"},ce=["src"],le={class:"holder flex flexcenter"},ie=P({__name:"[tripId]",setup(p){const y=O(),{tripId:n}=y.params,d=$({}),a=$(5);F(()=>{fetch(`/virtual-roadtrip/api/trips/${n}`).then(i=>i.json()).then(i=>{d.value=i,k()})});const u=$(0);let w;function k(){clearInterval(w),w=setInterval(async()=>{u.value=(u.value+1)%d.value.length},a.value*1e3)}const c=l(()=>d.value[u.value]),h=l(()=>{var i;return(i=c.value)==null?void 0:i.imgPath});function T(i){u.value=i,k()}return(i,M)=>{const m=R,L=ne;return f(),x(W,null,[o("div",ae,[I(m,{src:"/frame.png",class:"frameimg",level:8,style:v({filter:t(c)&&t(c).weather.isDark?"brightness(.5) grayscale(.6)":"brightness(1)"})},null,8,["style"]),o("div",re,[t(h)?(f(),x("img",{key:0,src:t(h),class:"reflection1",style:v({filter:t(c)&&t(c).weather.isDark?"contrast(1.3) brightness(.9)":""})},null,12,oe)):S("",!0)]),o("div",se,[t(h)?(f(),x("img",{key:0,src:t(h),class:"reflection2",style:v({filter:t(c)&&t(c).weather.isDark?"contrast(1.3) brightness(.9)":""})},null,12,ce)):S("",!0)])]),o("div",le,[o("div",{class:"flex flexcenter tripholder",style:v({filter:t(c)&&t(c).weather.isDark?"contrast(1.3) brightness(.9)":""})},[t(h)?(f(),G(m,{key:0,src:t(h),level:4.5,animate:!0,speed:1.2,class:"image"},null,8,["src","level","speed"])):S("",!0)],4)]),I(L,{trip:d.value,currentStageIndex:u.value,onChangeStage:T},null,8,["trip","currentStageIndex"])],64)}}});const ge=B(ie,[["__scopeId","data-v-8bd28975"]]);export{ge as default};
